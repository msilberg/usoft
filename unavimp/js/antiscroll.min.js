(function(e){function t(t,n){this.el=e(t);this.options=n||{};this.x=false!==this.options.x;this.y=false!==this.options.y;this.padding=undefined==this.options.padding?2:this.options.padding;this.inner=this.el.find(".antiscroll-inner");this.inner.css({width:"+="+s(),height:"+="+s()});this.refresh()}function n(t){this.pane=t;this.pane.el.append(this.el);this.innerEl=this.pane.inner.get(0);this.dragging=false;this.enter=false;this.shown=false;this.pane.el.mouseenter(e.proxy(this,"mouseenter"));this.pane.el.mouseleave(e.proxy(this,"mouseleave"));this.el.mousedown(e.proxy(this,"mousedown"));this.pane.inner.scroll(e.proxy(this,"scroll"));this.pane.inner.bind("mousewheel",e.proxy(this,"mousewheel"));var n=this.pane.options.initialDisplay;if(n!==false){this.show();this.hiding=setTimeout(e.proxy(this,"hide"),parseInt(n,10)||3e3)}}function r(e,t){function n(){}n.prototype=t.prototype;e.prototype=new n}function s(){if(i===undefined){var t=e('<div style="width:50px;height:50px;overflow:hidden;'+'position:absolute;top:-200px;left:-200px;"><div style="height:100px;">'+"</div>");e("body").append(t);var n=e("div",t).innerWidth();t.css("overflow-y","scroll");var r=e("div",t).innerWidth();e(t).remove();i=n-r}return i}e.fn.antiscroll=function(t){return this.each(function(){if(e(this).data("antiscroll")){e(this).data("antiscroll").destroy()}e(this).data("antiscroll",new e.Antiscroll(this,t))})};e.Antiscroll=t;t.prototype.refresh=function(){var e=this.inner.get(0).scrollWidth>this.el.width(),t=this.inner.get(0).scrollHeight>this.el.height();if(!this.horizontal&&e&&this.x){this.horizontal=new n.Horizontal(this)}else if(this.horizontal&&!e){this.horizontal.destroy();this.horizontal=null}if(!this.vertical&&t&&this.y){this.vertical=new n.Vertical(this)}else if(this.vertical&&!t){this.vertical.destroy();this.vertical=null}};t.prototype.destroy=function(){if(this.horizontal){this.horizontal.destroy()}if(this.vertical){this.vertical.destroy()}return this};t.prototype.rebuild=function(){this.destroy();this.inner.attr("style","");t.call(this,this.el,this.options);return this};n.prototype.destroy=function(){this.el.remove();return this};n.prototype.mouseenter=function(){this.enter=true;this.show()};n.prototype.mouseleave=function(){this.enter=false;if(!this.dragging){this.hide()}};n.prototype.scroll=function(){if(!this.shown){this.show();if(!this.enter&&!this.dragging){this.hiding=setTimeout(e.proxy(this,"hide"),1500)}}this.update()};n.prototype.mousedown=function(t){t.preventDefault();this.dragging=true;this.startPageY=t.pageY-parseInt(this.el.css("top"),10);this.startPageX=t.pageX-parseInt(this.el.css("left"),10);document.onselectstart=function(){return false};var n=this.pane,r=e.proxy(this,"mousemove"),i=this;e(document).mousemove(r).mouseup(function(){i.dragging=false;document.onselectstart=null;e(document).unbind("mousemove",r);if(!i.enter){i.hide()}})};n.prototype.show=function(e){if(!this.shown){this.update();this.el.addClass("antiscroll-scrollbar-shown");if(this.hiding){clearTimeout(this.hiding);this.hiding=null}this.shown=true}};n.prototype.hide=function(){var e=this.pane.options.autoHide;if(e!==false&&this.shown){this.el.removeClass("antiscroll-scrollbar-shown");this.shown=false}};n.Horizontal=function(t){this.el=e('<div class="antiscroll-scrollbar antiscroll-scrollbar-horizontal">');n.call(this,t)};r(n.Horizontal,n);n.Horizontal.prototype.update=function(){var e=this.pane.el.width(),t=e-this.pane.padding*2,n=this.pane.inner.get(0);this.el.css("width",t*e/n.scrollWidth).css("left",t*n.scrollLeft/n.scrollWidth)};n.Horizontal.prototype.mousemove=function(e){var t=this.pane.el.width()-this.pane.padding*2,n=e.pageX-this.startPageX,r=this.el.width(),i=this.pane.inner.get(0);var s=Math.min(Math.max(n,0),t-r);i.scrollLeft=(i.scrollWidth-this.pane.el.width())*s/(t-r)};n.Horizontal.prototype.mousewheel=function(e,t,n,r){if(n<0&&0==this.pane.inner.get(0).scrollLeft||n>0&&this.innerEl.scrollLeft+Math.ceil(this.pane.el.width())==this.innerEl.scrollWidth){e.preventDefault();return false}};n.Vertical=function(t){this.el=e('<div class="antiscroll-scrollbar antiscroll-scrollbar-vertical">');n.call(this,t)};r(n.Vertical,n);n.Vertical.prototype.update=function(){var e=this.pane.el.height(),t=e-this.pane.padding*2,n=this.innerEl;this.el.css("height",t*e/n.scrollHeight).css("top",t*n.scrollTop/n.scrollHeight)};n.Vertical.prototype.mousemove=function(e){var t=this.pane.el.height(),n=t-this.pane.padding*2,r=e.pageY-this.startPageY,i=this.el.height(),s=this.innerEl;var o=Math.min(Math.max(r,0),n-i);s.scrollTop=(s.scrollHeight-t)*o/(n-i)};n.Vertical.prototype.mousewheel=function(e,t,n,r){if(r>0&&0==this.innerEl.scrollTop||r<0&&this.innerEl.scrollTop+Math.ceil(this.pane.el.height())==this.innerEl.scrollHeight){e.preventDefault();return false}};var i;})(jQuery)
