bMap.storesRootAttr=new Array({fill:"#ffffff",stroke:"#00a8e3","stroke-width":1});bMap.storesAttr=new Array({fill:"#ffffff",stroke:"#00a8e3","stroke-width":2});bMap.flagRootAttr=new Array({fill:"#ff5f17",stroke:"#00a8e3","stroke-width":2});bMap.flagAttr=new Array({fill:"#ff5f17",stroke:"#00a8e3","stroke-width":3});bMap.storesMarkedAttr=new Array({fill:"#F07746"});bMap.linkerAttr=new Array({fill:"#ffffff",opacity:0});bMap.circlePassAttr=new Array({fill:"90-#f79844-#b80642",stroke:"none",r:4});bMap.circleActAttr=new Array({fill:"90-#fcec22-#d2a14d",stroke:"none",r:4});bMap.modTargetAttr=new Array({fill:"#00c400",stroke:"#00c400",opacity:1});bMap.levNameTextColor="#00a7e6";bMap.linker=[];bMap.prevMark=[];bMap.somCrit=false;bMap.loadIval=500;bMap.openLevel=function(a){$.get(addrUrl.svapi("is_root,lev","false,"+a),function(){if(bVars.isRoot){bVars.isRoot=false;for(var b=0;b<bMap.varsArr["larr"].length;b++){paperRoot[bMap.varsArr["larr"][b]].remove()}bMap.rlevNamesCanvas.remove()}else{paperLevel[bMap.varsArr["lev"]].remove()}bMap.prevMark.length=0;uBody.makeMapBtnPass();bMap.setMap();$("td.mw").append("<div class='loop-cont'></div>");$("div.loop-cont").load(addrUrl.loadBlock("loop"),function(){uBody.sclHandler()});if(bVars.store!=null){$.getJSON(addrUrl.api+11,function(b){if(uServe.inArray(a,b)){setTimeout(function(){bMap.storeOnMap(true);uBody.makeBcPass()},bMap.loadIval)}else{bMap.eraseMarkedStore()}})}})};bMap.back2root=function(){if(bVars.isRoot){if(!uBody.closeMinisite()){bVars.store=null}bMap.clearStores();setTimeout(function(){bMap.clearStores()},500)}else{bVars.isRoot=true;uServe.resetMap();bMap.setMap();uBody.closeMinisite(true);if(bVars.store!=null){if(bVars.atClick&&bMap.somCrit){setTimeout(function(){bMap.storeOnMap(true)},900)}else{bVars.store=null;$("div.bc-otp-cont").remove();$("div.bc-arr").hide()}}else{bVars.store=null}mSnd.resetScale();uBody.manipulateMapControls()}uServe.clearCat(true);if($("div.list-cont").length>0){$("div.list-cont").remove()}bMap.prevMark.length=0;uBody.closeSi();uBody.makeMapBtnAct();if($("div.bc-level").hasClass("cbtn-pass")){$("div.bc-level").removeClass("cbtn-pass").addClass("bc-level-act")}$("div.bc-level").hide();$.get(addrUrl.api+16)};bMap.lbOtp=function(){bMap.lbArr.length=0;$.getJSON(addrUrl.api+3,function(a){$.each(a,function(a,b){var c=0;$.each(b,function(b,d){if(bVars.isRoot){bMap.lbArr[c]=paperRoot[a].path(d.path);bMap.lbArr[c].scale(bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"])}else{bMap.lbArr[c]=paperLevel[a].path(d.path)}bMap.lbArr[c].attr(d.attr);bMap.lbArr[c++].drag(mSnd.move,mSnd.start,mSnd.up)})})})};bMap.btlOtp=function(){var a;$.getJSON(addrUrl.api+4,function(b){if(uServe.arrayKeys(b).length==0){return false}$.each(b,function(b,c){if(bVars.isRoot){a=paperRoot[b]}else{a=paperLevel[b]}$.each(c,function(b,c){bMap.textArr.push(a.text(c.coords[0],c.coords[1],c.text));uServe.end(bMap.textArr).rotate(c.rotate);uServe.end(bMap.textArr).attr(c.attr);if(bVars.isRoot){uServe.end(bMap.textArr).scale(bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"])}})})})};bMap.storeRootBuild=function(a){var b;b=paperRoot[a.key].path(a.area);b.scale(bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"]);b.attr(bMap.storesRootAttr);return b};bMap.storeLevelBuild=function(a,b){var c;switch(a.switcher){case 0:c=paperLevel[a.key].path(b.area);c.attr(bMap.storesAttr);break;case 1:c=paperLevel[a.key].text(b.textCoords[0],b.textCoords[1],b.name);c.attr(b.textAttr);c.rotate(b.textRotate);break;case 2:c=paperLevel[a.key].circle(b.circle[0],b.circle[1]);c.attr(bMap.circlePassAttr);break}c.drag(mSnd.move,mSnd.start,mSnd.up);c.click(function(){uBody.openMinisite(a.storeId)});return c};bMap.storesOtp=function(){bMap.storesArr.length=0;bMap.textArr.length=0;bMap.circleArr.length=0;bMap.linker.length=0;$.getJSON(addrUrl.api+5,function(a){$.each(a,function(a,b){$.each(b,function(b,c){if(bVars.isRoot){if(typeof c.mls!="undefined"){if(typeof bMap.storesArr[c.id]=="undefined"){bMap.storesArr[c.id]=[]}if(typeof c.area=="string"){var d=new Object({key:a,area:c.area});bMap.storesArr[c.id].push(bMap.storeRootBuild(d))}else if(typeof c.area=="object"){var e=bMap.storesArr[c.id].length;for(var f=0;f<c.area.length;f++){var d=new Object({key:a,area:c.area[f]});bMap.storesArr[c.id][e++]=bMap.storeRootBuild(d)}}}else{var d=new Object({key:a,area:c.area});bMap.storesArr[c.id]=bMap.storeRootBuild(d)}}else{var g=new Object({key:a,storeId:c.id});if(typeof c.area=="string"){g.switcher=0;var h=new Object({area:c.area});bMap.storesArr[c.id]=bMap.storeLevelBuild(g,h);g.switcher=1;var h=new Object({textCoords:c.textCoords,name:c.name,textAttr:c.textAttr,textRotate:c.textRotate});bMap.textArr[c.id]=bMap.storeLevelBuild(g,h);if(c.circle!=null){g.switcher=2;var h=new Object({circle:c.circle});bMap.circleArr[c.id]=bMap.storeLevelBuild(g,h)}}else if(typeof c.area=="object"){bMap.storesArr[c.id]=[];bMap.textArr[c.id]=[];bMap.circleArr[c.id]=[];for(var e=0;e<c.area.length;e++){g.switcher=0;var h=new Object({area:c.area[e]});bMap.storesArr[c.id][e]=bMap.storeLevelBuild(g,h);g.switcher=1;var h=new Object({textCoords:c.textCoords[e],name:c.name,textAttr:c.textAttr[e],textRotate:c.textRotate[e]});bMap.textArr[c.id][e]=bMap.storeLevelBuild(g,h);if(c.circle[e]!=null){g.switcher=2;var h=new Object({circle:c.circle[e]});bMap.circleArr[c.id][e]=bMap.storeLevelBuild(g,h)}}}}});if(bVars.cat!=null){bMap.markStores();uBody.makeBcPass()}if(!bVars.isRoot&&bVars.si!=null){uBody.showSi();uBody.makeBcPass()}if(bVars.isRoot){bMap.linker[a]=paperRoot[a].rect(0,0,bMap.varsArr["canvas_w"]*bMap.varsArr["nscale"],bMap.varsArr["canvas_h"]*bMap.varsArr["nscale"]);bMap.linker[a].attr(bMap.linkerAttr);bMap.linker[a].click(function(){bMap.openLevel(a)})}})})};bMap.eraseMarkedStore=function(){if(bVars.store!=null){bVars.store=null}bMap.somCrit=false;$("div.bc-otp-cont").remove();$("div.bc-arr").hide()};bMap.clearStores=function(){if(bMap.prevMark.length==0){return false}var a;if(bVars.isRoot){a=bMap.storesRootAttr}else{a=bMap.storesAttr}$.each(bMap.prevMark,function(b,c){if(typeof c=="object"){$.each(c.ind,function(b,d){bMap.storesArr[c.id][d].attr(a)})}else{bMap.storesArr[c].attr(a)}});if(uServe.arrayKeys(bMap.flagArr).length>0){$.each(bMap.flagArr,function(a,b){b.remove()})}bMap.eraseMarkedStore();bMap.prevMark.length=0};bMap.clearSiFlags=function(){if(bMap.siFlagArr.length<1){return false}$.each(uServe.arrayKeys(bMap.siFlagArr),function(a,b){bMap.siFlagArr[parseFloat(b)].remove()})};bMap.markStores=function(){if(bVars.store!=null){return false}$.getJSON(addrUrl.api+6,function(a){bMap.clearStores();$.each(a,function(a,b){if(typeof bMap.storesArr[b]!="undefined"){if(bMap.storesArr[b].length>1){tArr=[];$.each(bMap.storesArr[b],function(a,b){b.attr(bMap.storesMarkedAttr);tArr.push(a)});bMap.prevMark.push({id:b,ind:tArr})}else{bMap.storesArr[b].attr(bMap.storesMarkedAttr);bMap.prevMark.push(b)}}})})};bMap.markChosenStore=function(a,b,c){var d,e;var f=[];if(bVars.isRoot){d=paperRoot[c]}else{d=paperLevel[bMap.varsArr["lev"]]}if(typeof b=="object"){$.each(b,function(a,b){bMap.flagArr.push(d.path(b))})}else if(typeof b=="string"){bMap.flagArr.push(d.path(b))}$.each(bMap.flagArr,function(a,b){b.attr(bMap.flagAttr);if(bVars.isRoot){b.scale(bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"]);b.attr("stroke-width",2)}});if(uServe.inArray("id",uServe.arrayKeys(bMap.storesArr[a]))){bMap.storesArr[a].attr(bMap.storesMarkedAttr);bMap.prevMark.push(a)}else{e=bMap.prevMark.length==0;$.each(bMap.storesArr[a],function(a,b){b.attr(bMap.storesMarkedAttr);if(e){f.push(a)}});if(e){bMap.prevMark=[{id:a,ind:f}]}}};bMap.storeOnMap=function(a){$.getJSON(addrUrl.api+7,function(b){var c;bMap.flagArr.length=0;bMap.somCrit=true;mSnd.resetScale(true);$("div.bc-otp").load(addrUrl.loadBlock("storename"),function(){$("div.bc-store-name").click(function(){uBody.openMinisite(bVars.store)})});if(bVars.isRoot){$("div.bc-arr").hide();if(uServe.arrayKeys(b).length>1||a){uBody.makeMapBtnPass();$.each(b,function(a,b){bMap.markChosenStore(bVars.store,b,a)});if(!a){bMap.clearTarget();bMap.targetOtp()}}else{c=parseFloat(uServe.arrayKeys(b)[0]);$.get(addrUrl.svapi("lev",c),function(){bMap.openLevel(c);uServe.loadLevSwitch();$.each(b,function(a,b){bMap.markChosenStore(bVars.store,b)});uBody.makeBcPass()})}}else{$("div.bc-arr").show();if(uServe.inArray(bMap.varsArr["lev"],uServe.arrayKeys(b))){setTimeout(function(){$.each(b,function(a,b){bMap.markChosenStore(bVars.store,b)})},bMap.loadIval);if(!a){bMap.clearTarget();bMap.targetOtp()}}else{$.get(addrUrl.svapi("lev",parseFloat(uServe.arrayKeys(b)[0])),function(){paperLevel[bMap.varsArr["lev"]].remove();bMap.setMap();uServe.loadLevSwitch();setTimeout(function(){$.each(b,function(a,b){bMap.markChosenStore(bVars.store,b)});uBody.makeBcPass()},800)})}}})};bMap.markSi=function(){var a;var b=0;bMap.clearSiFlags();$.each(bMap.varsArr["ssi_arr"],function(c,d){$.each(d,function(d,e){if(bVars.isRoot){bMap.siFlagArr[b]=paperRoot[c].path(e);bMap.siFlagArr[b].scale(bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"]);bMap.siFlagArr[b].click(function(){bMap.openLevel(c)});a=bMap.flagRootAttr}else{bMap.siFlagArr[b]=paperLevel[c].path(e);a=bMap.flagAttr}bMap.siFlagArr[b++].attr(a)})})};bMap.clearTarget=function(){if(uServe.arrayKeys(bMap.modTarget).length==0){return false}clearInterval(bMap.modTargetInt);bMap.modTarget.remove()};bMap.targetOtp=function(){var a;var b=.05;var c=.4;var d=1;var e=false;$.getJSON(addrUrl.api+10,function(b){$.each(b,function(b,c){if(!bVars.isRoot){if(b==bMap.varsArr["lev"]){bMap.targetOnMap=true}else{bMap.targetOnMap=false;return false}}if(bVars.isRoot){a=paperRoot[b]}else{a=paperLevel[b]}bMap.modTarget=a.path(c);bMap.modTarget.attr(bMap.modTargetAttr);if(bVars.isRoot){bMap.modTarget.click(function(){bMap.openLevel(b)})}else{bMap.modTarget.attr("opacity",.7)}bMap.modTarget.scale(bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"],bMap.varsArr["nscale"])})});if(bMap.modTargetInt!=null){clearInterval(bMap.modTargetInt)}bMap.modTargetInt=setInterval(function(){if(d==1&&e){e=false}else if(d<=b+c){e=true}if(!e){d-=b}else if(e){d+=b}bMap.modTarget.scale(d,d)},60)};mSnd.sclBorders=function(){mSnd.mw=1120;mSnd.mh=725;bMap.mPointer=paperLevel[bMap.varsArr["lev"]].rect(0,0,1,1);mSnd.xBegInit=bMap.mPointer.getBBox().x;mSnd.yBegInit=bMap.mPointer.getBBox().y;mSnd.xEndInit=mSnd.xBegInit+mSnd.mw;mSnd.yEndInit=mSnd.yBegInit+mSnd.mh};mSnd.getTextSize=function(){mSnd.fsizeInit.length=0;mSnd.fsize.length=0;$.each(uServe.runMapArr(bMap.textArr),function(a,b){mSnd.fsizeInit.push(b.attr("font-size"));mSnd.fsize.push(b.attr("font-size"))})};mSnd.moveIt=function(a,b){$.each(uServe.runMapArr(bMap.lbArr),function(c,d){d.translate(a,b)});$.each(uServe.runMapArr(bMap.storesArr),function(c,d){d.translate(a,b)});if(bMap.circleArr.length>0){$.each(uServe.runMapArr(bMap.circleArr),function(c,d){d.translate(a,b)})}if(bMap.siFlagArr.length>0){$.each(uServe.runMapArr(bMap.siFlagArr),function(c,d){d.translate(a,b)})}$.each(uServe.runMapArr(bMap.textArr),function(c,d){d.translate(a,b)});bMap.mPointer.translate(a,b);if(bMap.flagArr.length>0){$.each(uServe.runMapArr(bMap.flagArr),function(c,d){d.translate(a,b)})}};mSnd.getCurrCoords=function(){mSnd.xBegCurr=bMap.mPointer.getBBox().x;mSnd.yBegCurr=bMap.mPointer.getBBox().y;mSnd.xEndCurr=mSnd.xBegCurr+mSnd.mw*mSnd.vscale;mSnd.yEndCurr=mSnd.yBegCurr+mSnd.mh*mSnd.vscale};mSnd.alignIt=function(){var a,b;if(mSnd.sclCount==0){a=mSnd.xBegCurr-mSnd.xBegInit;b=mSnd.yBegCurr-mSnd.yBegInit}else{a=(mSnd.xBegCurr-mSnd.xBegInit)/mSnd.sclCount;b=(mSnd.yBegCurr-mSnd.yBegInit)/mSnd.sclCount}a*=-1;b*=-1;mSnd.moveIt(a,b);mSnd.getCurrCoords()};mSnd.objScaleOwn=function(){$.each(uServe.runMapArr(bMap.lbArr),function(a,b){b.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale)});$.each(uServe.runMapArr(bMap.storesArr),function(a,b){b.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale)});if(bMap.circleArr.length>0){$.each(uServe.runMapArr(bMap.circleArr),function(a,b){b.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale)})}if(bMap.siFlagArr.length>0){$.each(uServe.runMapArr(bMap.siFlagArr),function(a,b){b.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale)})}if(bMap.flagArr.length>0){$.each(uServe.runMapArr(bMap.flagArr),function(a,b){b.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale)})}};mSnd.controlSclButtons=function(a){if(a){$("div.scale-plus").removeClass("scale-btn-act").addClass("scale-btn-pass");$("div.loop-stick-plus").removeClass("loop-stick-act").addClass("loop-stick-pass");$("div.scale-minus").removeClass("scale-btn-pass").addClass("scale-btn-act");$("div.loop-stick-minus").removeClass("loop-stick-pass").addClass("loop-stick-act")}else{if(mSnd.sclCount>0){$("div.scale-minus").removeClass("scale-btn-act").addClass("scale-btn-pass");$("div.loop-stick-minus").removeClass("loop-stick-act").addClass("loop-stick-pass")}else{$("div.scale-minus").removeClass("scale-btn-pass").addClass("scale-btn-act");$("div.loop-stick-minus").removeClass("loop-stick-pass").addClass("loop-stick-act")}if(mSnd.sclCount==8){$("div.scale-plus").removeClass("scale-btn-pass").addClass("scale-btn-act");$("div.loop-stick-plus").removeClass("loop-stick-pass").addClass("loop-stick-act")}else{$("div.scale-plus").removeClass("scale-btn-act").addClass("scale-btn-pass");$("div.loop-stick-plus").removeClass("loop-stick-act").addClass("loop-stick-pass")}}};mSnd.txtOxCorr=function(a){if($.browser.mozilla){if(!(a.attr("text").indexOf("\n")>-1)&&(a.attr("text").charAt(0)=="A"||a.attr("text").charAt(1)=="А")){a.translate(.5,0)}}else if($.browser.webkit){a.translate(.31,0)}};mSnd.pScale=function(){if(mSnd.sclCount<=mSnd.sclLim){mSnd.vscale+=mSnd.sclStep*mSnd.sclTimes;$.each(uServe.runMapArr(bMap.textArr),function(a,b){for(var c=0;c<mSnd.sclTimes;c++){mSnd.fsize[a]*=1+mSnd.fpstep}b.attr("font-size",mSnd.fsize[a]);b.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale);mSnd.txtOxCorr(b)});bMap.mPointer.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale);mSnd.sclCount+=mSnd.sclTimes;mSnd.getCurrCoords();mSnd.controlSclButtons();if(bMap.targetOnMap){bMap.modTarget.hide()}mSnd.objScaleOwn();if(bMap.targetOnMap&&bMap.varsArr["sclcorr_ox"]!=null&&bMap.varsArr["sclcorr_oy"]!=null){mSnd.moveIt(bMap.varsArr["sclcorr_ox"]*mSnd.vscale*mSnd.sclTimes,bMap.varsArr["sclcorr_oy"]*mSnd.vscale*mSnd.sclTimes);mSnd.getCurrCoords()}}};mSnd.nScale=function(){if(mSnd.sclCount>=1){mSnd.vscale-=mSnd.sclStep*mSnd.sclTimes;if(mSnd.sclCount==1||mSnd.sclTimes>1){$.each(uServe.runMapArr(bMap.textArr),function(a,b){b.attr("font-size",mSnd.fsizeInit[a]);b.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale);mSnd.fsize[a]=mSnd.fsizeInit[a];mSnd.txtOxCorr(b)})}else{$.each(uServe.runMapArr(bMap.textArr),function(a,b){mSnd.fsize[a]*=1-mSnd.fnstep;b.attr("font-size",mSnd.fsize[a]);b.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale);mSnd.txtOxCorr(b)})}mSnd.objScaleOwn();bMap.mPointer.scale(mSnd.vscale,mSnd.vscale,mSnd.vscale,mSnd.vscale);mSnd.sclCount-=mSnd.sclTimes;mSnd.getCurrCoords();mSnd.alignIt();if(bMap.targetOnMap&&mSnd.sclCount==0){bMap.modTarget.show()}mSnd.controlSclButtons()}};mSnd.resetScale=function(a){if(mSnd.sclCount==0){return false}if(a){mSnd.sclTimes=mSnd.sclCount;mSnd.nScale()}else{mSnd.sclCount=0;mSnd.sclTimes=1;mSnd.vscale=1}};mSnd.stopIt=function(){$.each(uServe.runMapArr(bMap.lbArr),function(a,b){b.undrag()});$.each(uServe.runMapArr(bMap.storesArr),function(a,b){b.undrag()});if(bMap.circleArr.length>0){$.each(uServe.runMapArr(bMap.circleArr),function(a,b){b.undrag()})}if(bMap.siFlagArr.length>0){$.each(uServe.runMapArr(bMap.siFlagArr),function(a,b){b.undrag()})}$.each(uServe.runMapArr(bMap.textArr),function(a,b){b.undrag()});bMap.mPointer.undrag();if(bMap.flagArr.length>0){$.each(uServe.runMapArr(bMap.flagArr),function(a,b){b.undrag()})}};mSnd.start=function(){mSnd.x0=0;mSnd.y0=0;clearTimeout(mSnd.mfWd);mSnd.mtWd=setTimeout(function(){mSnd.wd=true},500)};mSnd.move=function(a,b){if(mSnd.sclCount>0){mSnd.getCurrCoords();mSnd.dxt=a-mSnd.x0;mSnd.dyt=b-mSnd.y0;if(mSnd.xBegCurr>=mSnd.xBegInit&&mSnd.dxt>0||mSnd.xEndCurr<=mSnd.xEndInit&&mSnd.dxt<0){mSnd.dxt=0}if(mSnd.yBegCurr>=mSnd.yBegInit&&mSnd.dyt>0||mSnd.yEndCurr<=mSnd.yEndInit&&mSnd.dyt<0){mSnd.dyt=0}if(mSnd.dxt==0&&mSnd.dyt==0){mSnd.stopIt()}else{mSnd.moveIt(mSnd.dxt,mSnd.dyt)}mSnd.x0=a;mSnd.y0=b}};mSnd.up=function(){clearInterval(mSnd.mtWd);mSnd.mfWd=setTimeout(function(){mSnd.wd=false},1e3)};bMap.setMap=function(){bMap.varsArr=[];bMap.clearTarget();if(bVars.isRoot){$.get(addrUrl.svapi("is_root","true"),function(){$.getJSON(addrUrl.vapi+"larr,ccoords,canvas_w,canvas_h,nscale,lang,dlang,rccorrox,rccorroy,rlevnames_coords,lev_names,wdir",function(a){bMap.varsArr=a;bMap.rlevNamesCanvas=Raphael(bMap.varsArr["rlevnames_coords"][0],bMap.varsArr["rlevnames_coords"][1],bMap.varsArr["canvas_w"],bMap.varsArr["canvas_h"]);$.each(bMap.varsArr["larr"],function(a,b){bMap.levNamesArr.push(bMap.rlevNamesCanvas.text(bMap.varsArr["lev_names"][b]["pos"][0],bMap.varsArr["lev_names"][b]["pos"][1],bMap.varsArr["lev_names"][b]["name"]));uServe.end(bMap.levNamesArr).attr({fill:bMap.levNameTextColor,"font-size":bMap.varsArr["lev_names"][b]["size"]});if(bMap.varsArr["lev_names"][b]["rotate"]!=0){uServe.end(bMap.levNamesArr).rotate(bMap.varsArr["lev_names"][b]["rotate"])}uServe.end(bMap.levNamesArr).click(function(){bMap.openLevel(b)});paperRoot[b]=Raphael(bMap.varsArr["ccoords"][a][0],bMap.varsArr["ccoords"][a][1],bMap.varsArr["canvas_w"]*bMap.varsArr["nscale"]*bMap.varsArr["rccorrox"],bMap.varsArr["canvas_h"]*bMap.varsArr["nscale"]*bMap.varsArr["rccorroy"])});bMap.lbOtp();setTimeout(function(){bMap.storesOtp();bMap.btlOtp()},400);setTimeout(function(){bMap.targetOtp()},900)})})}else{$.getJSON(addrUrl.vapi+"larr,corr_xmap,corr_ymap,canvas_w,canvas_h,lev,sclcorr_ox,sclcorr_oy,lang,dlang,wdir",function(a){bMap.varsArr=a;paperLevel[bMap.varsArr["lev"]]=Raphael(bMap.varsArr["corr_xmap"],bMap.varsArr["corr_ymap"],bMap.varsArr["canvas_w"],bMap.varsArr["canvas_h"]);mSnd.sclBorders();bMap.mPointer.attr("stroke","none");bMap.lbOtp();$.get(addrUrl.api+15);setTimeout(function(){bMap.storesOtp();bMap.btlOtp()},400);setTimeout(function(){bMap.targetOtp();mSnd.getTextSize()},900)});uBody.showBc()}}